{"ast":null,"code":"import React,{useEffect,useState}from'react';import View from\"react-native-web/dist/exports/View\";import Text from\"react-native-web/dist/exports/Text\";import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import FlatList from\"react-native-web/dist/exports/FlatList\";import TouchableOpacity from\"react-native-web/dist/exports/TouchableOpacity\";import Alert from\"react-native-web/dist/exports/Alert\";import{collection,query,where,getDocs,deleteDoc,doc}from'firebase/firestore';import{FIREBASE_DB,FIREBASE_AUTH}from'../../FirebaseCongig';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const Cart=({onBack})=>{const[cartItems,setCartItems]=useState([]);const[isLoading,setIsLoading]=useState(true);const user=FIREBASE_AUTH.currentUser;useEffect(()=>{loadCartItems();},[]);const loadCartItems=async()=>{if(!user)return;try{const cartRef=collection(FIREBASE_DB,'panier');const q=query(cartRef,where('userId','==',user.uid));const querySnapshot=await getDocs(q);const items=[];querySnapshot.forEach(doc=>{items.push(Object.assign({id:doc.id},doc.data()));});setCartItems(items);}catch(error){Alert.alert('Erreur','Impossible de charger le panier');}finally{setIsLoading(false);}};const removeFromCart=async itemId=>{try{await deleteDoc(doc(FIREBASE_DB,'panier',itemId));setCartItems(prevItems=>prevItems.filter(item=>item.id!==itemId));Alert.alert('Succès','Article retiré du panier');}catch(error){Alert.alert('Erreur','Impossible de retirer l\\'article');}};const renderCartItem=({item})=>_jsxs(View,{style:styles.cartItem,children:[_jsxs(View,{style:styles.itemInfo,children:[_jsx(Text,{style:styles.itemName,children:item.nom}),_jsxs(Text,{style:styles.itemPrice,children:[item.prix.toFixed(2),\" \\u20AC\"]})]}),_jsx(TouchableOpacity,{style:styles.removeButton,onPress:()=>removeFromCart(item.id),children:_jsx(Text,{style:styles.removeButtonText,children:\"Retirer\"})})]});if(isLoading){return _jsx(View,{style:styles.centerContainer,children:_jsx(Text,{children:\"Chargement du panier...\"})});}const total=cartItems.reduce((sum,item)=>sum+item.prix,0);return _jsxs(View,{style:styles.container,children:[_jsxs(View,{style:styles.header,children:[_jsx(TouchableOpacity,{onPress:onBack,children:_jsx(Text,{style:styles.backButton,children:\"\\u2190 Retour\"})}),_jsx(Text,{style:styles.headerTitle,children:\"Mon Panier\"}),_jsx(View,{style:{width:50}})]}),cartItems.length===0?_jsx(View,{style:styles.centerContainer,children:_jsx(Text,{children:\"Votre panier est vide\"})}):_jsxs(_Fragment,{children:[_jsx(FlatList,{data:cartItems,renderItem:renderCartItem,keyExtractor:item=>item.id,contentContainerStyle:styles.listContainer}),_jsx(View,{style:styles.totalContainer,children:_jsxs(Text,{style:styles.totalText,children:[\"Total: \",total.toFixed(2),\" \\u20AC\"]})})]})]});};const styles=StyleSheet.create({container:{flex:1,backgroundColor:'#f5f5f5'},header:{flexDirection:'row',alignItems:'center',justifyContent:'space-between',padding:16,backgroundColor:'#42b983'},headerTitle:{color:'white',fontSize:18,fontWeight:'bold'},backButton:{color:'white',fontSize:16,fontWeight:'bold'},centerContainer:{flex:1,justifyContent:'center',alignItems:'center'},listContainer:{padding:16},cartItem:{flexDirection:'row',backgroundColor:'white',padding:16,borderRadius:8,marginBottom:12,alignItems:'center',elevation:2,shadowColor:'#000',shadowOffset:{width:0,height:2},shadowOpacity:0.1,shadowRadius:4},itemInfo:{flex:1},itemName:{fontSize:16,fontWeight:'bold',marginBottom:4},itemPrice:{fontSize:14,color:'#666'},removeButton:{backgroundColor:'#ff4444',padding:8,borderRadius:6,marginLeft:12},removeButtonText:{color:'white',fontSize:14,fontWeight:'bold'},totalContainer:{padding:16,borderTopWidth:1,borderTopColor:'#ddd',backgroundColor:'white'},totalText:{fontSize:18,fontWeight:'bold',textAlign:'right'}});export default Cart;","map":{"version":3,"names":["React","useEffect","useState","View","Text","StyleSheet","FlatList","TouchableOpacity","Alert","collection","query","where","getDocs","deleteDoc","doc","FIREBASE_DB","FIREBASE_AUTH","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Cart","onBack","cartItems","setCartItems","isLoading","setIsLoading","user","currentUser","loadCartItems","cartRef","q","uid","querySnapshot","items","forEach","push","Object","assign","id","data","error","alert","removeFromCart","itemId","prevItems","filter","item","renderCartItem","style","styles","cartItem","children","itemInfo","itemName","nom","itemPrice","prix","toFixed","removeButton","onPress","removeButtonText","centerContainer","total","reduce","sum","container","header","backButton","headerTitle","width","length","renderItem","keyExtractor","contentContainerStyle","listContainer","totalContainer","totalText","create","flex","backgroundColor","flexDirection","alignItems","justifyContent","padding","color","fontSize","fontWeight","borderRadius","marginBottom","elevation","shadowColor","shadowOffset","height","shadowOpacity","shadowRadius","marginLeft","borderTopWidth","borderTopColor","textAlign"],"sources":["c:/Users/socid/OneDrive/Documents/ITU/EXAM WEB/essaiFirebase/app/screens/Cart.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  FlatList,\n  TouchableOpacity,\n  Alert,\n} from 'react-native';\nimport { collection, query, where, getDocs, deleteDoc, doc } from 'firebase/firestore';\nimport { FIREBASE_DB, FIREBASE_AUTH } from '../../FirebaseCongig';\n\ninterface CartItem {\n  id: string;\n  nom: string;\n  prix: number;\n  tps_cuisson: number;\n}\n\ninterface Props {\n  onBack: () => void;\n}\n\nconst Cart: React.FC<Props> = ({ onBack }) => {\n  const [cartItems, setCartItems] = useState<CartItem[]>([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const user = FIREBASE_AUTH.currentUser;\n\n  useEffect(() => {\n    loadCartItems();\n  }, []);\n\n  const loadCartItems = async () => {\n    if (!user) return;\n\n    try {\n      const cartRef = collection(FIREBASE_DB, 'panier');\n      const q = query(cartRef, where('userId', '==', user.uid));\n      const querySnapshot = await getDocs(q);\n\n      const items: CartItem[] = [];\n      querySnapshot.forEach((doc) => {\n        items.push({\n          id: doc.id,\n          ...doc.data(),\n        } as CartItem);\n      });\n\n      setCartItems(items);\n    } catch (error) {\n      Alert.alert('Erreur', 'Impossible de charger le panier');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const removeFromCart = async (itemId: string) => {\n    try {\n      await deleteDoc(doc(FIREBASE_DB, 'panier', itemId));\n      setCartItems((prevItems) => prevItems.filter((item) => item.id !== itemId));\n      Alert.alert('Succès', 'Article retiré du panier');\n    } catch (error) {\n      Alert.alert('Erreur', 'Impossible de retirer l\\'article');\n    }\n  };\n\n  const renderCartItem = ({ item }: { item: CartItem }) => (\n    <View style={styles.cartItem}>\n      <View style={styles.itemInfo}>\n        <Text style={styles.itemName}>{item.nom}</Text>\n        <Text style={styles.itemPrice}>{item.prix.toFixed(2)} €</Text>\n      </View>\n      <TouchableOpacity\n        style={styles.removeButton}\n        onPress={() => removeFromCart(item.id)}\n      >\n        <Text style={styles.removeButtonText}>Retirer</Text>\n      </TouchableOpacity>\n    </View>\n  );\n\n  if (isLoading) {\n    return (\n      <View style={styles.centerContainer}>\n        <Text>Chargement du panier...</Text>\n      </View>\n    );\n  }\n\n  const total = cartItems.reduce((sum, item) => sum + item.prix, 0);\n\n  return (\n    <View style={styles.container}>\n      <View style={styles.header}>\n        <TouchableOpacity onPress={onBack}>\n          <Text style={styles.backButton}>← Retour</Text>\n        </TouchableOpacity>\n        <Text style={styles.headerTitle}>Mon Panier</Text>\n        <View style={{ width: 50 }} />\n      </View>\n\n      {cartItems.length === 0 ? (\n        <View style={styles.centerContainer}>\n          <Text>Votre panier est vide</Text>\n        </View>\n      ) : (\n        <>\n          <FlatList\n            data={cartItems}\n            renderItem={renderCartItem}\n            keyExtractor={(item) => item.id}\n            contentContainerStyle={styles.listContainer}\n          />\n          <View style={styles.totalContainer}>\n            <Text style={styles.totalText}>Total: {total.toFixed(2)} €</Text>\n          </View>\n        </>\n      )}\n    </View>\n  );\n};\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: '#f5f5f5',\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    padding: 16,\n    backgroundColor: '#42b983',\n  },\n  headerTitle: {\n    color: 'white',\n    fontSize: 18,\n    fontWeight: 'bold',\n  },\n  backButton: {\n    color: 'white',\n    fontSize: 16,\n    fontWeight: 'bold',\n  },\n  centerContainer: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  listContainer: {\n    padding: 16,\n  },\n  cartItem: {\n    flexDirection: 'row',\n    backgroundColor: 'white',\n    padding: 16,\n    borderRadius: 8,\n    marginBottom: 12,\n    alignItems: 'center',\n    elevation: 2,\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: 2 },\n    shadowOpacity: 0.1,\n    shadowRadius: 4,\n  },\n  itemInfo: {\n    flex: 1,\n  },\n  itemName: {\n    fontSize: 16,\n    fontWeight: 'bold',\n    marginBottom: 4,\n  },\n  itemPrice: {\n    fontSize: 14,\n    color: '#666',\n  },\n  removeButton: {\n    backgroundColor: '#ff4444',\n    padding: 8,\n    borderRadius: 6,\n    marginLeft: 12,\n  },\n  removeButtonText: {\n    color: 'white',\n    fontSize: 14,\n    fontWeight: 'bold',\n  },\n  totalContainer: {\n    padding: 16,\n    borderTopWidth: 1,\n    borderTopColor: '#ddd',\n    backgroundColor: 'white',\n  },\n  totalText: {\n    fontSize: 18,\n    fontWeight: 'bold',\n    textAlign: 'right',\n  },\n});\n\nexport default Cart;\n"],"mappings":"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","ignoreList":[]},"metadata":{"hasCjsExports":false},"sourceType":"module","externalDependencies":[]}